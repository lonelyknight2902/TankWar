(()=>{"use strict";var e,t={742:(e,t,s)=>{s(440);const i=1200,a=.2*Math.PI,h=Phaser.Math.RadToDeg(a),n=.02*a;class o{constructor(){this.score=0,this.highScore=0,this.score=0,this.highScore=localStorage.getItem("highScore")?parseInt(localStorage.getItem("highScore")):0}static getInstance(){return o.instance||(o.instance=new o),o.instance}getScore(){return this.score}getHighScore(){return this.highScore}increaseScore(e){this.score+=e}resetScore(){this.score=0}setHighScore(e){this.highScore=e,localStorage.setItem("highScore",this.highScore.toString())}}const r=o;class l extends Phaser.GameObjects.Sprite{constructor(e){super(e.scene,e.x,e.y,e.texture),this.rotation=e.rotation,this.initImage(),this.setScale(1.5),this.bigHitSound=this.scene.sound.add("bigHit"),this.mediumHitSound=this.scene.sound.add("mediumHit"),this.smallHitSound=this.scene.sound.add("smallHit"),this.scene.add.existing(this)}initImage(){this.bulletSpeed=1e3,this.setOrigin(.5,.5),this.setDepth(2),this.scene.physics.world.enable(this),this.scene.physics.velocityFromRotation(this.rotation-Math.PI/2,this.bulletSpeed,this.body.velocity),this.anims.create({key:"explode",frames:[{key:"explosion1"},{key:"explosion2"},{key:"explosion3"},{key:"explosion4"}],frameRate:15,repeat:0})}update(){}explode(e=()=>{},t="none",s=10){this.anims.isPlaying||(this.hit(t,s),this.anims.play("explode",!0).on("animationcomplete",(()=>{this.destroy(),e()})))}hit(e,t=10){switch(e){case"big":this.bigHitSound.play({source:{refDistance:t}});break;case"medium":this.mediumHitSound.play({source:{refDistance:t}});break;case"small":this.smallHitSound.play({source:{refDistance:t}})}}}const c=l;class d extends Phaser.GameObjects.Sprite{constructor(e){super(e.scene,e.x,e.y,e.texture),this.rotation=e.rotation,this.initImage(),this.setScale(.5),this.hitSound=this.scene.sound.add("smallHit"),this.scene.add.existing(this)}initImage(){this.bulletSpeed=2e3,this.setOrigin(.5,.5),this.setDepth(2),this.scene.physics.world.enable(this),this.scene.physics.velocityFromRotation(this.rotation-Math.PI/2,this.bulletSpeed,this.body.velocity),this.anims.create({key:"explode",frames:[{key:"explosion1"},{key:"explosion2"},{key:"explosion3"},{key:"explosion4"}],frameRate:15,repeat:0})}update(){}explode(e=()=>{},t="",s=10){this.anims.isPlaying||(this.hit(t,s),this.anims.play("explode",!0).on("animationcomplete",(()=>{this.destroy(),e()})))}hit(e,t=10){e&&this.hitSound.play({source:{refDistance:t},volume:.5})}}const u=d;class p extends Phaser.GameObjects.Image{getBullets(){return this.bullets}getMGBullets(){return this.mgbullets}constructor(e){super(e.scene,e.x,e.y,e.texture,e.frame),this.initImage(),this.fireSound=this.scene.sound.add("cannonFire"),this.mgFireSound=this.scene.sound.add("mgFire"),this.shellSound=this.scene.sound.add("cannonShellDrop"),this.reloadSound=this.scene.sound.add("cannonReload"),this.mgShellSound=this.scene.sound.add("mgShellDrop"),this.mgFireLastShotSound=this.scene.sound.add("mgFireLastShot"),this.mgLastShellSound=this.scene.sound.add("mgLastShell"),this.repairSound=this.scene.sound.add("repair",{volume:.5}),this.turretTurn=this.scene.sound.add("turretTurn",{volume:.3}),this.engineSound0=this.scene.sound.add("engine0",{volume:.5}),this.engineSound1=this.scene.sound.add("engine1",{volume:.5}),this.engineSound2=this.scene.sound.add("engine2",{volume:.5}),this.engineSound3=this.scene.sound.add("engine3",{volume:.5}),this.damageSpeeches=[this.scene.sound.add("damage1",{volume:3}),this.scene.sound.add("damage2",{volume:3}),this.scene.sound.add("damage3",{volume:3}),this.scene.sound.add("damage4",{volume:3})],this.killSpeeches=[this.scene.sound.add("kill1",{volume:3}),this.scene.sound.add("kill2",{volume:3}),this.scene.sound.add("kill3",{volume:3}),this.scene.sound.add("kill4",{volume:3})],this.trackSounds=[this.scene.sound.add("track1",{volume:.3}),this.scene.sound.add("track2",{volume:.3}),this.scene.sound.add("track3",{volume:.3})],this.currentTrack=this.trackSounds[0],this.smokeEmitter=this.scene.add.particles(0,0,"smoke",{blendMode:"MULTIPLY",scale:{start:.5,end:1},speed:{min:20,max:40},quantity:1,lifespan:1e3,gravityY:-50,follow:this,followOffset:{x:0,y:-10}}),this.smokeEmitter.setDepth(5),this.smokeEmitter.stop(),this.scene.add.existing(this)}initImage(){this.health=100,this.maxHealth=100,this.lastShoot=0,this.lastMGShoot=0,this.speed=100,this.setOrigin(.5,.5),this.setDepth(0),this.angle=180,this.muzzleFlash=this.scene.add.image(this.x,this.y,"muzzleFlash"),this.muzzleFlash.setDepth(6),this.muzzleFlash.setAlpha(0),this.muzzleFlash.setOrigin(.5),this.muzzleFlash.setScale(2),this.mgMuzzleFlash=this.scene.add.image(this.x,this.y,"mgMuzzleFlash"),this.mgMuzzleFlash.setDepth(6),this.mgMuzzleFlash.setAlpha(0),this.mgMuzzleFlash.setOrigin(.5),this.barrel=this.scene.physics.add.sprite(this.x,this.y,"barrelBlue"),this.barrel.setOrigin(.5,1),this.barrel.setDepth(1),this.barrel.angle=180,this.setScale(2),this.barrel.setScale(2),this.lifeBar=this.scene.add.graphics(),this.lifeBar.setDepth(6),this.redrawLifebar(),this.reloadingCircle=this.scene.add.graphics(),this.reloadingCircle.setDepth(6),this.reloadingCircle.name="reloadingCircle",this.reloadingPercentage=100,this.repairPercentage=100,this.repairCircle=this.scene.add.graphics(),this.repairCircle.setDepth(6),this.repairCircle.name="repairCircle",this.isRepaired=!0,this.wrench=this.scene.add.image(this.x,this.y,"wrench"),this.wrench.setOrigin(.5),this.wrench.setVisible(!1),this.wrench.name="wrench",this.wrench.setDepth(6),this.crosshair=this.scene.add.image(0,0,"crosshair"),this.crosshair.setOrigin(.5),this.bullets=this.scene.add.group({active:!0,maxSize:10,runChildUpdate:!0}),this.mgbullets=this.scene.add.group({active:!0,maxSize:20,runChildUpdate:!0}),this.scene.input.keyboard&&(this.cursors=this.scene.input.keyboard.createCursorKeys(),this.rotateKeyLeft=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),this.rotateKeyRight=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),this.forwardKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),this.backwardKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.shootingKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE),this.repairKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.F),this.mgShootingKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE)),this.scene.physics.world.enable(this);const e=this.body;e.setDamping(!0),e.setMaxSpeed(this.speed),this.state="idle"}update(e,t){this.active?(this.barrel.x=this.x,this.barrel.y=this.y,this.lifeBar.x=this.x,this.lifeBar.y=this.y,this.handleInput(),this.handleShooting(),this.handleMGShooting(),this.repairKey.isDown?(this.health<this.maxHealth&&this.repairPercentage>=100&&this.isRepaired&&(this.repairPercentage=0,this.isRepaired=!1),console.log(this.isRepaired),this.repairPercentage<100?(this.repairSound.isPlaying||this.repairSound.play({loop:!0}),this.wrench.setVisible(!0),this.wrench.setPosition(this.x,this.y),this.repairPercentage+=.025*t,this.repairCircle.clear(),this.repairCircle.lineStyle(10,16777215),this.repairCircle.beginPath(),this.repairCircle.arc(this.x,this.y,20,0,Phaser.Math.DegToRad(3.6*this.repairPercentage%360)),this.repairCircle.strokePath()):(this.repairCircle.clear(),this.repairSound.stop(),this.wrench.setVisible(!1),console.log("done: ",this.isRepaired),this.isRepaired||(this.health<this.maxHealth&&(console.log(this.health),this.health+=40,console.log(this.health),this.health>this.maxHealth&&(console.log(this.health,this.maxHealth),this.health=this.maxHealth),this.redrawLifebar()),this.health>.3*this.maxHealth&&this.smokeEmitter.stop(),this.isRepaired=!0))):(this.repairCircle.clear(),this.repairSound.stop(),this.wrench.setVisible(!1)),this.reloadingPercentage<100?(this.reloadingPercentage+=.025*t,this.reloadingCircle.clear(),this.reloadingCircle.lineStyle(10,16711680),this.reloadingCircle.beginPath(),this.reloadingCircle.arc(this.x,this.y-50,20,0,Phaser.Math.DegToRad(3.6*this.reloadingPercentage%360)),this.reloadingCircle.strokePath()):this.reloadingCircle.clear(),0==this.body.speed?(this.engineSound0.isPlaying||this.engineSound0.play(),this.engineSound1.isPlaying&&this.engineSound1.stop(),this.engineSound2.isPlaying&&this.engineSound2.stop(),this.engineSound3.isPlaying&&this.engineSound3.stop(),this.currentTrack.stop()):this.body.speed<100/3?(this.engineSound0.isPlaying&&this.engineSound0.stop(),this.engineSound1.isPlaying||this.engineSound1.play(),this.engineSound2.isPlaying&&this.engineSound2.stop(),this.engineSound3.isPlaying&&this.engineSound3.stop(),this.currentTrack!=this.trackSounds[0]&&this.currentTrack.stop(),this.currentTrack=this.trackSounds[0],this.currentTrack.isPlaying||this.currentTrack.play({loop:!0})):this.body.speed<200/3?(this.engineSound0.isPlaying&&this.engineSound0.stop(),this.engineSound1.isPlaying&&this.engineSound1.stop(),this.engineSound2.isPlaying||this.engineSound2.play(),this.engineSound3.isPlaying&&this.engineSound3.stop(),this.currentTrack!=this.trackSounds[1]&&this.currentTrack.stop(),this.currentTrack=this.trackSounds[1],this.currentTrack.isPlaying||this.currentTrack.play({loop:!0})):(this.engineSound0.isPlaying&&this.engineSound0.stop(),this.engineSound1.isPlaying&&this.engineSound1.stop(),this.engineSound2.isPlaying&&this.engineSound2.stop(),this.engineSound3.isPlaying||this.engineSound3.play(),this.currentTrack!=this.trackSounds[2]&&this.currentTrack.stop(),this.currentTrack=this.trackSounds[2],this.currentTrack.isPlaying||this.currentTrack.play({loop:!0}))):(this.destroy(),this.barrel.destroy(),this.lifeBar.destroy())}handleInput(){this.body.setAcceleration(0),this.body.setDrag(0),this.body.angularVelocity=0,this.rotateKeyLeft.isDown&&"backward"!=this.state||this.rotateKeyRight.isDown&&"backward"==this.state?this.body.angularVelocity=-h:(this.rotateKeyRight.isDown&&"backward"!=this.state||this.rotateKeyLeft.isDown&&"backward"==this.state)&&(this.body.angularVelocity=h),this.forwardKey.isDown?(this.body.acceleration.setToPolar(this.rotation-Math.PI/2,this.speed),this.body.speed<3&&(this.state="forward"),"forward"===this.state?this.scene.physics.velocityFromRotation(this.rotation-Math.PI/2,this.body.speed,this.body.velocity):(this.body.setDrag(.2),this.scene.physics.velocityFromRotation(this.rotation+Math.PI/2,this.body.speed,this.body.velocity))):this.backwardKey.isDown?(this.body.acceleration.setToPolar(this.rotation+Math.PI/2,this.speed),this.body.speed<3&&(this.state="backward"),"backward"===this.state?this.scene.physics.velocityFromRotation(this.rotation+Math.PI/2,this.body.speed,this.body.velocity):(this.body.setDrag(.2),this.scene.physics.velocityFromRotation(this.rotation-Math.PI/2,this.body.speed,this.body.velocity))):this.body.setDrag(.3),!this.forwardKey.isDown&&!this.backwardKey.isDown&&this.body.speed<3&&(this.body.setVelocity(0),this.state="idle"),this.pointerMove(this.scene.input.activePointer),this.scene.physics.velocityFromRotation(this.barrel.rotation,0,this.barrel.body.velocity)}pointerMove(e){const t=Phaser.Math.Angle.Between(this.barrel.x,this.barrel.y,e.worldX,e.worldY)+Math.PI/2,s=Phaser.Math.Angle.Wrap(t-this.barrel.rotation);if(Phaser.Math.Fuzzy.Equal(s,0,n))this.barrel.rotation=t,this.barrel.body.setAngularVelocity(0),this.turretTurn.stop(),this.crosshair.setPosition(e.worldX,e.worldY);else{this.barrel.body.setAngularVelocity(Math.sign(s)*h),this.turretTurn.isPlaying||this.turretTurn.play({loop:!0});const t=Phaser.Math.Distance.Between(this.barrel.x,this.barrel.y,e.worldX,e.worldY),i=this.barrel.x+Math.cos(this.barrel.rotation-Math.PI/2)*t,a=this.barrel.y+Math.sin(this.barrel.rotation-Math.PI/2)*t;this.crosshair.setPosition(i,a)}}handleShooting(){if(this.scene.input.activePointer.isDown&&this.scene.time.now>this.lastShoot&&!this.reloadSound.isPlaying){this.scene.cameras.main.shake(20,.005),this.fireSound.play(),this.reloadingPercentage=0,this.shellSound.play({delay:1,volume:.5}),this.reloadSound.play({delay:1.5,volume:.5}),this.scene.tweens.add({targets:this,props:{alpha:.8},delay:0,duration:5,ease:"Power1",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!0,paused:!1}),this.muzzleFlash.setRotation(this.barrel.rotation+Math.PI);const e=this.barrel.x+70*Math.cos(this.barrel.rotation-Math.PI/2),t=this.barrel.y+70*Math.sin(this.barrel.rotation-Math.PI/2);if(this.muzzleFlash.setPosition(e,t),this.scene.tweens.add({targets:this.muzzleFlash,props:{alpha:1},delay:0,duration:100,ease:"Power1",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!0,paused:!1}),this.bullets.getLength()<10){const e=new c({scene:this.scene,rotation:this.barrel.rotation,x:this.barrel.x,y:this.barrel.y,texture:"bulletBlue"});e.setScale(3),this.bullets.add(e),this.lastShoot=this.scene.time.now+4e3}}}handleMGShooting(){if(this.mgShootingKey.isDown&&this.scene.time.now>this.lastMGShoot){this.mgFireSound.isPlaying||this.mgFireSound.play({loop:!0}),this.mgShellSound.isPlaying||this.mgShellSound.play({delay:.2,volume:1,loop:!0}),this.scene.tweens.add({targets:this,props:{alpha:.8},delay:0,duration:5,ease:"Power1",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!0,paused:!1}),this.mgMuzzleFlash.setRotation(this.barrel.rotation+Math.PI);const e=this.barrel.x+70*Math.cos(this.barrel.rotation-Math.PI/2),t=this.barrel.y+70*Math.sin(this.barrel.rotation-Math.PI/2);if(this.mgMuzzleFlash.setPosition(e,t),this.scene.tweens.add({targets:this.mgMuzzleFlash,props:{alpha:1},delay:0,duration:70,ease:"Power1",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!0,paused:!1}),this.mgbullets.getLength()<20){const e=new u({scene:this.scene,rotation:this.barrel.rotation,x:this.barrel.x,y:this.barrel.y,texture:"bulletBlue"});e.setScale(1),this.mgbullets.add(e),this.lastMGShoot=this.scene.time.now+100}}else this.scene.time.now>this.lastMGShoot&&(this.mgFireSound.isPlaying&&(this.mgFireSound.stop(),this.mgFireLastShotSound.play()),this.mgShellSound.isPlaying&&(this.mgShellSound.stop(),this.mgLastShellSound.play()),this.mgMuzzleFlash.setAlpha(0))}redrawLifebar(){this.lifeBar.clear(),this.lifeBar.fillStyle(15100456,1),this.lifeBar.fillRect(-this.width/2,this.height/2,this.width*this.health/this.maxHealth,15),this.lifeBar.lineStyle(2,16777215),this.lifeBar.strokeRect(-this.width/2,this.height/2,this.width,15),this.lifeBar.setDepth(1)}updateHealth(){this.damageSpeeches[Phaser.Math.RND.between(0,3)].play(),this.health>0?(this.health-=10,this.redrawLifebar(),this.health/this.maxHealth<.3?this.smokeEmitter.start():this.smokeEmitter.stop()):(this.health=0,this.active=!1)}killEnemy(){this.killSpeeches[Phaser.Math.RND.between(0,3)].play()}}const y=p;class g extends Phaser.GameObjects.Image{getBarrel(){return this.barrel}getBullets(){return this.bullets}constructor(e){super(e.scene,e.x,e.y,e.texture,e.frame),this.initContainer(),this.explodeSound=this.scene.sound.add("explosion"),this.smokeEmitter=this.scene.add.particles(0,0,"smoke",{blendMode:"MULTIPLY",scale:{start:.5,end:1},speed:{min:20,max:40},quantity:1,lifespan:1e3,gravityY:-50,follow:this,followOffset:{x:0,y:-10}}),this.smokeEmitter.setDepth(5),this.smokeEmitter.stop(),this.scene.add.existing(this)}initContainer(){this.health=100,this.maxHealth=100,this.lastShoot=0,this.speed=100,this.setDepth(0),this.muzzleFlash=this.scene.add.image(0,0,"muzzleFlash"),this.muzzleFlash.setOrigin(.5),this.muzzleFlash.setDepth(6),this.muzzleFlash.setAlpha(0),this.muzzleFlash.setScale(2),this.barrel=this.scene.add.image(0,0,"barrelRed"),this.barrel.setOrigin(.5,1),this.barrel.setDepth(1),this.lifeBar=this.scene.add.graphics(),this.redrawLifebar(),this.bullets=this.scene.add.group({active:!0,maxSize:10,runChildUpdate:!0}),this.scene.tweens.add({targets:this,props:{y:this.y-200},delay:0,duration:2e3,ease:"Linear",easeParams:null,hold:0,repeat:-1,repeatDelay:0,yoyo:!0}),this.scene.physics.world.enable(this)}update(){this.active?(this.barrel.x=this.x,this.barrel.y=this.y,this.lifeBar.x=this.x,this.lifeBar.y=this.y,this.handleShooting()):(this.destroy(),this.barrel.destroy(),this.lifeBar.destroy())}handleShooting(){this.scene.time.now>this.lastShoot&&(this.muzzleFlash.x=this.barrel.x+70*Math.cos(this.barrel.rotation-Math.PI/2),this.muzzleFlash.y=this.barrel.y+70*Math.sin(this.barrel.rotation-Math.PI/2),this.muzzleFlash.rotation=this.barrel.rotation+Math.PI,this.scene.tweens.add({targets:this.muzzleFlash,alpha:1,duration:100,ease:"Power1",yoyo:!0,repeat:0}),this.bullets.getLength()<10&&(this.bullets.add(new c({scene:this.scene,rotation:this.barrel.rotation,x:this.barrel.x,y:this.barrel.y,texture:"bulletRed"})),this.lastShoot=this.scene.time.now+4e3))}redrawLifebar(){this.lifeBar.clear(),this.lifeBar.fillStyle(15100456,1),this.lifeBar.fillRect(-this.width/2,this.height/2,this.width*this.health/this.maxHealth,15),this.lifeBar.lineStyle(2,16777215),this.lifeBar.strokeRect(-this.width/2,this.height/2,this.width,15),this.lifeBar.setDepth(1)}updateHealth(e=10){this.health>0?(this.health-=e,this.health<0&&(this.health=0),this.redrawLifebar(),this.health/this.maxHealth<.3&&this.smokeEmitter.start()):(this.health=0,this.active=!1,this.explodeSound.play(),this.smokeEmitter.stop())}}const m=g;class b extends Phaser.GameObjects.Image{constructor(e){super(e.scene,e.x,e.y,e.texture),this.initImage(),this.scene.add.existing(this)}initImage(){this.setOrigin(0,0),this.scene.physics.world.enable(this),this.body.setImmovable(!0)}update(){}}const S=class{},x=class extends S{constructor(e){super(),this.scene=e}enter(){console.log("Playing"),this.scene.input.setDefaultCursor("url(assets/cursors/target_round_a.png) 16 16, pointer")}execute(e,t){console.log("Playing");const s=this.scene.getPlayer();s.update(e,t),this.scene.getGameUI().update(e,t),this.scene.getEnemies().getChildren().forEach((e=>{if(e.update(),s.active&&e.active){const t=Phaser.Math.Angle.Between(e.body.x,e.body.y,s.body.x,s.body.y);e.getBarrel().angle=(t+Math.PI/2)*Phaser.Math.RAD_TO_DEG}}),this),this.scene.getEnemies().getChildren().every((e=>!e.active))&&this.stateMachine.transition("gameover")}exit(){console.log("Game Over"),this.scene.input.setDefaultCursor("url(assets/cursors/cursor_none.png), pointer")}},f=class extends S{constructor(e){super(),this.scene=e}enter(){console.log("Paused"),this.scene.physics.pause(),this.scene.tweens.pauseAll(),this.scene.sound.pauseAll();const e=this.scene.getPauseUI();e.setVisible(!0),e.setActive(!0)}execute(e,t){console.log("Paused")}exit(){console.log("Unpaused"),this.scene.physics.resume(),this.scene.tweens.resumeAll(),this.scene.sound.resumeAll();const e=this.scene.getPauseUI();e.setVisible(!1),e.setActive(!1)}},k=class extends S{constructor(e){super(),this.scene=e,this.explodeSound=this.scene.sound.add("playerExplosion")}enter(){console.log("Game Over"),this.scene.physics.pause(),this.scene.tweens.getTweens().forEach((e=>{e.pause()})),this.scene.sound.pauseAll(),this.explodeSound.play();const e=this.scene.getGameOverUI();e.setVisible(!0),e.setActive(!0),e.display()}execute(e,t){console.log("Game Over")}exit(){console.log("Game Over"),this.scene.physics.resume(),this.scene.tweens.resumeAll(),this.scene.sound.resumeAll();const e=this.scene.getGameOverUI();e.setVisible(!1),e.setActive(!1)}},w=class{constructor(e,t){this.initialState=e,this.state=null,this.possibleStates=t;for(const e in this.possibleStates)this.possibleStates[e].stateMachine=this}update(e,t){null===this.state&&(this.state=this.initialState,this.possibleStates[this.state].enter()),this.possibleStates[this.state].execute(e,t)}transition(e){this.state&&this.possibleStates[this.state].exit(),this.state=e,this.possibleStates[this.state].enter()}getCurrentState(){return this.state}};class P extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y,e.children);const{type:t,hoverType:s,icon:i,text:a,callback:h,width:n,height:o}=e;this.background=this.scene.add.nineslice(0,0,t,0,0,0,10,10,10,10),this.add(this.background),s&&(this.hoverBackground=this.scene.add.nineslice(0,0,s,0,0,0,10,10,10,10),this.add(this.hoverBackground),this.hoverBackground.setVisible(!1)),a&&(this.text=this.scene.add.text(0,0,a,{color:"#16bb77",fontSize:"32px",fontFamily:"Helvetica",fontStyle:"bold"}),this.add(this.text)),i&&(this.icon=this.scene.add.image(0,0,i),this.icon.setTintFill(1489783),this.add(this.icon)),n&&(this.background.width=n,this.hoverBackground&&(this.hoverBackground.width=n)),o&&(this.background.height=o,this.hoverBackground&&(this.hoverBackground.height=o)),a&&i?(console.log("both"),this.text.setAlign("right"),Phaser.Display.Align.In.LeftCenter(this.icon,this.background,-10,0),Phaser.Display.Align.In.LeftCenter(this.text,this.background,-20-this.icon.width,0)):a?(console.log("text"),Phaser.Display.Align.In.Center(this.text,this.background)):i&&(console.log("icon"),Phaser.Display.Align.In.Center(this.icon,this.background)),this.callback=h,this.setSize(this.background.displayWidth,this.background.displayHeight),this.setInteractive({cursor:"url(assets/cursors/hand_point.png), pointer"}).on("pointerdown",(()=>{console.log("click"),this.setY(this.y+5)})),this.on("pointerup",(()=>{this.callback(),this.setY(this.y-5)})),this.on("pointerover",(()=>{this.hoverBackground?(this.background.setVisible(!1),this.hoverBackground.setVisible(!0)):this.background.setTint(1489783),this.icon&&this.icon.clearTint(),this.text&&this.text.setColor("#fff")})),this.on("pointerout",(()=>{this.hoverBackground?(this.background.setVisible(!0),this.hoverBackground.setVisible(!1)):this.background.clearTint(),this.icon&&this.icon.setTintFill(1489783),this.text&&this.text.setColor("#16bb77"),console.log("pointerout")})),this.setScrollFactor(0),this.scene.add.existing(this)}getIcon(){return this.icon}}const v=P;class M extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y,e.children),this.background=e.scene.add.nineslice(0,0,"buttonRectangleDepthLine",0,600,400,10,10,10,10);const t=e.scene.add.text(0,0,"Pause",{color:"#ffffff",fontSize:"64px",fontFamily:"Helvetica",fontStyle:"bold",stroke:"#000000",strokeThickness:20});this.continueButton=new v({scene:e.scene,x:0,y:0,type:"buttonRectangleDepthBorder",hoverType:"buttonRectangleDepthFlat",icon:"forward",text:"Continue",callback:()=>{console.log("continue"),this.scene.getStateMachine().transition("play")},width:250,height:80}),this.newGameButton=new v({scene:e.scene,x:0,y:0,type:"buttonRectangleDepthBorder",hoverType:"buttonRectangleDepthFlat",icon:"return",text:"New Game",callback:()=>{console.log("new game"),this.scene.cameras.main.fadeOut(500,0,0,0),this.scene.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(()=>{this.scene.scene.restart()}))},width:250,height:80}),this.audioButton=new v({scene:e.scene,x:0,y:0,type:"buttonRectangleDepthBorder",hoverType:"buttonRectangleDepthFlat",icon:"audioOn",callback:()=>{console.log("audio");const e=this.audioButton.getIcon();"audioOn"===e.texture.key?(e.setTexture("audioOff"),this.scene.sound.mute=!0):(e.setTexture("audioOn"),this.scene.sound.mute=!1)},width:80,height:80}),Phaser.Display.Align.In.TopCenter(t,this.background,0,-50),Phaser.Display.Align.In.Center(this.audioButton,this.background,0,0),Phaser.Display.Align.In.BottomLeft(this.continueButton,this.background,-30,-50),Phaser.Display.Align.In.BottomRight(this.newGameButton,this.background,-30,-50),this.setSize(this.background.displayWidth,this.background.displayHeight),this.setScrollFactor(0),this.setInteractive(),this.background.setDepth(10),this.add(this.background),this.add(t),this.add(this.continueButton),this.add(this.newGameButton),this.add(this.audioButton),this.setDepth(10),this.scene.add.existing(this)}}const I=M;class D extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y,e.children),this.background=e.scene.add.nineslice(0,0,"buttonRectangleDepthLine",0,600,700,10,10,10,10);const t=e.scene.add.text(0,0,"Game Over",{color:"#ffffff",fontSize:"64px",fontFamily:"Helvetica",fontStyle:"bold",stroke:"#000000",strokeThickness:20}),s=e.scene.add.text(0,0,"Score",{color:"#000000",fontSize:"32px",fontFamily:"Helvetica",fontStyle:"bold"});s.setOrigin(.5),this.scoreText=e.scene.add.text(0,0,"0",{color:"#ffffff",fontSize:"48px",fontFamily:"Helvetica",fontStyle:"bold",stroke:"#000000",strokeThickness:10}),this.scoreText.setOrigin(.5);const i=e.scene.add.text(0,0,"High Score",{color:"#000000",fontSize:"32px",fontFamily:"Helvetica",fontStyle:"bold"});i.setOrigin(.5),this.highScoreText=e.scene.add.text(0,0,"0",{color:"#ffffff",fontSize:"48px",fontFamily:"Helvetica",fontStyle:"bold",stroke:"#000000",strokeThickness:10}),this.highScoreText.setOrigin(.5),this.newGameButton=new v({scene:e.scene,x:0,y:0,type:"buttonRectangleDepthBorder",hoverType:"buttonRectangleDepthFlat",icon:"return",text:"New Game",callback:()=>{console.log("new game"),this.scene.cameras.main.fadeOut(500,0,0,0),this.scene.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((e,t)=>{this.scene.scene.restart()}))},width:250,height:80}),this.menuButton=new v({scene:e.scene,x:0,y:0,type:"buttonRectangleDepthBorder",hoverType:"buttonRectangleDepthFlat",icon:"home",text:"Menu",callback:()=>{console.log("menu"),this.scene.cameras.main.fadeOut(500,0,0,0),this.scene.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((e,t)=>{this.scene.scene.start("MenuScene")}))},width:250,height:80}),Phaser.Display.Align.In.TopCenter(t,this.background,0,-50),Phaser.Display.Align.In.Center(s,this.background,0,-150),Phaser.Display.Align.In.Center(this.scoreText,this.background,0,-100),Phaser.Display.Align.In.Center(i,this.background,0,0),Phaser.Display.Align.In.Center(this.highScoreText,this.background,0,50),Phaser.Display.Align.In.BottomLeft(this.menuButton,this.background,-30,-50),Phaser.Display.Align.In.BottomRight(this.newGameButton,this.background,-30,-50),this.setSize(this.background.displayWidth,this.background.displayHeight),this.setScrollFactor(0),this.setInteractive(),this.background.setDepth(10),this.add([this.background,t,s,this.scoreText,i,this.highScoreText,this.newGameButton,this.menuButton]),this.setDepth(10),this.scoreManager=r.getInstance(),this.highScoreText.setText(`${this.scoreManager.getHighScore()}`),this.scene.add.existing(this)}displayScore(){const e=this.scoreManager.getScore(),t=this.scoreManager.getHighScore();console.log(e,t);let s=t;e>t&&(s=e,this.scoreManager.setHighScore(s)),this.scene.tweens.addCounter({from:0,to:e,duration:1e3,delay:1e3,onUpdate:e=>{this.scoreText.setText(`${Math.floor(e.getValue())}`)},onComplete:()=>{this.scoreManager.resetScore(),this.scene.tweens.addCounter({from:t,to:s,duration:1e3,delay:500,onUpdate:e=>{this.highScoreText.setText(`${Math.floor(e.getValue())}`),console.log(e.getValue())}})}})}}const B=D;class T extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y,e.children),this.medal=this.scene.add.sprite(0,0,e.medal?e.medal:"goldMedal"),e.text&&(this.text=this.scene.add.text(0,0,e.text,{color:"#ffffff",fontSize:"48px",fontFamily:"Helvetica",fontStyle:"bold",stroke:"#000000",strokeThickness:15}),this.text.setOrigin(1,0),this.add(this.text)),e.score&&(this.score=this.scene.add.text(0,0,e.score,{color:"#ffffff",fontSize:"24px",fontFamily:"Helvetica",fontStyle:"bold",stroke:"#000000",strokeThickness:10}),this.score.setOrigin(0,1),this.add(this.score)),this.add(this.medal),e.width&&e.height?(this.setSize(e.width,e.height),this.medal.setScale(e.height/this.medal.height)):this.setSize(300,300),Phaser.Display.Align.In.LeftCenter(this.medal,this),Phaser.Display.Align.In.TopRight(this.text,this),Phaser.Display.Align.In.BottomRight(this.score,this),this.score.x=this.text.x-this.text.width,this.scene.add.existing(this)}}const C=T;class z extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y,e.children),this.setSize(1600,i),this.setScrollFactor(0),this.pauseButton=new v({scene:e.scene,x:0,y:0,type:"buttonSquareDepthBorder",hoverType:"buttonSquareDepthFlat",icon:"pause",callback:()=>{console.log("pause"),this.scene.getStateMachine().transition("pause")},width:80,height:80}),this.medal=new C({scene:e.scene,x:0,y:0,medal:"goldMedal",score:"+100",text:"Enemy Killed",height:100,width:400}),this.score=this.scene.add.text(10,10,"Score: 0",{fontFamily:"Helvetica",fontStyle:"bold",fontSize:48,color:"#ffffff",stroke:"#000000",strokeThickness:10}),this.add(this.pauseButton),this.add(this.medal),this.add(this.score),this.scoreManager=r.getInstance(),this.currentScore=0,this.updatingScore=!1,Phaser.Display.Align.In.TopRight(this.pauseButton,this.scene.add.zone(this.scene.cameras.main.width,0,0,0),-10,-10),Phaser.Display.Align.In.TopCenter(this.medal,this.scene.add.zone(this.scene.cameras.main.width/2,0,0,0),0,200),Phaser.Display.Align.In.TopLeft(this.score,this.scene.add.zone(0,0,0,0),-10,-10),this.scene.add.existing(this)}update(e,t){const s=this.scoreManager.getScore();s===this.currentScore||this.updatingScore||(this.updatingScore=!0,this.scene.tweens.addCounter({from:this.currentScore,to:s,duration:100,onUpdate:e=>{this.currentScore=Math.floor(e.getValue()),this.score.text=`Score: ${this.currentScore}`},onComplete:()=>{this.updatingScore=!1}}))}showMedal(){this.scene.tweens.add({targets:this.medal,y:250,duration:500,ease:"Quad.easeOut",repeat:0,yoyo:!1,onComplete:()=>{this.scene.tweens.add({targets:this.medal,y:-150,duration:500,ease:"Quad.easeIn",repeat:0,delay:2e3,yoyo:!1})}})}}const O=z;class F extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y,e.children),this.setSize(e.scene.sys.canvas.width,e.scene.sys.canvas.height),this.setScrollFactor(0),this.popup=new I({scene:e.scene,x:0,y:0}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.scene.add.zone(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,0,0)),this.setDepth(10),this.scene.add.existing(this)}}const H=F;class A extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y,e.children),this.setSize(e.scene.sys.canvas.width,e.scene.sys.canvas.height),this.setScrollFactor(0),this.popup=new B({scene:e.scene,x:0,y:0}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.scene.add.zone(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,0,0)),this.setDepth(10),this.scene.add.existing(this)}display(){this.popup.displayScore()}}const E=A;class R extends Phaser.Scene{constructor(){super({key:"GameScene"})}init(){}create(){var e;this.map=this.make.tilemap({key:"levelMap"}),this.tileset=this.map.addTilesetImage("tiles"),this.tileset&&(this.layer=this.map.createLayer("tileLayer",this.tileset,0,0),null===(e=this.layer)||void 0===e||e.setCollisionByProperty({collide:!0})),this.obstacles=this.add.group({runChildUpdate:!0}),this.enemies=this.add.group({}),this.convertObjects(),this.layer&&(this.physics.add.collider(this.player,this.layer),this.physics.add.collider(this.player,this.obstacles),this.physics.add.collider(this.player.getBullets(),this.layer,this.bulletHitLayer,void 0,this),this.physics.add.collider(this.player.getMGBullets(),this.layer,this.bulletHitLayer,void 0,this),this.physics.add.collider(this.player.getMGBullets(),this.obstacles,this.bulletHitObstacles,void 0,this),this.physics.add.collider(this.player.getBullets(),this.obstacles,this.bulletHitObstacles,void 0,this),this.enemies.getChildren().forEach((e=>{this.physics.add.overlap(this.player.getBullets(),e,this.playerBulletHitEnemy,void 0,this),this.physics.add.overlap(this.player.getMGBullets(),e,this.playerMGBulletHitEnemy,void 0,this),this.enemyHitPlayerOverlap=this.physics.add.overlap(e.getBullets(),this.player,this.enemyBulletHitPlayer,void 0,this),this.physics.add.collider(e.getBullets(),this.obstacles,this.bulletHitObstacles,void 0),this.physics.add.collider(e.getBullets(),this.layer,this.bulletHitLayer,void 0)}),this)),this.stateMachine=new w("play",{play:new x(this),pause:new f(this),gameover:new k(this)}),this.scoreManager=r.getInstance(),this.ambientSound=this.sound.add("ambient"),this.warAmbientSound=this.sound.add("warAmbient"),this.ambientSound.play({loop:!0,volume:.2}),this.warAmbientSound.play({loop:!0,volume:.2}),this.musics=[this.sound.add("music3"),this.sound.add("music4")],this.sound.stopAll(),this.musics[1].play({loop:!0,volume:.8}),this.cameras.main.startFollow(this.player),this.gameUI=new O({x:0,y:0,scene:this}),this.pauseUI=new H({x:0,y:0,scene:this}),this.pauseUI.setVisible(!1),this.pauseUI.setActive(!1),this.gameOverUI=new E({x:0,y:0,scene:this}),this.pauseUI.setVisible(!1),this.pauseUI.setActive(!1),this.gameOverUI.setVisible(!1),this.gameOverUI.setActive(!1),this.cameras.main.fadeIn(1e3,0,0,0)}update(e,t){this.stateMachine.update(e,t)}convertObjects(){var e;(null===(e=this.map.getObjectLayer("objects"))||void 0===e?void 0:e.objects).forEach((e=>{if("player"===e.type)this.player=new y({scene:this,x:e.x,y:e.y,texture:"tankBlue"});else if("enemy"===e.type){const t=new m({scene:this,x:e.x,y:e.y,texture:"tankRed"});this.enemies.add(t)}else{const t=new b({scene:this,x:e.x,y:e.y-40,texture:e.type});this.obstacles.add(t)}}))}bulletHitLayer(e){e.body.setVelocity(0),e.explode()}bulletHitObstacles(e,t){e.body.setVelocity(0),e.explode()}enemyBulletHitPlayer(e,t){e.body.setVelocity(0),this.cameras.main.shake(100,.01),this.physics.world.remove(e.body),console.log("hit"),e.explode((()=>{if(t.updateHealth(),t.active){const e=this.add.text(t.x,t.y,"-10",{fontSize:"48px",color:"red",fontStyle:"bold",fontFamily:"Helvetica",stroke:"black",strokeThickness:10});e.setOrigin(.5),this.tweens.add({targets:e,y:e.y-50,alpha:0,duration:500,onComplete:()=>{e.destroy()}})}else this.stateMachine.transition("gameover")}),"big")}playerBulletHitEnemy(e,t){e.body.setVelocity(0),this.physics.world.remove(e.body);const s=Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)/1e3;e.explode((()=>{if(t.updateHealth(),t.active){const e=this.add.text(this.player.x,this.player.y,"Enemy Hit",{fontSize:"24px",color:"white",fontStyle:"bold",fontFamily:"Helvetica"});this.scoreManager.increaseScore(10),e.setOrigin(.5),this.tweens.add({targets:e,y:e.y-50,alpha:0,duration:1e3,onComplete:()=>{e.destroy()}})}else{this.player.killEnemy(),this.scoreManager.increaseScore(100),this.gameUI.showMedal();const e=this.add.text(this.player.x,this.player.y,"Enemy killed",{fontSize:"48px",color:"white",fontStyle:"bold",fontFamily:"Helvetica"});e.setOrigin(.5),this.tweens.add({targets:e,y:e.y-50,alpha:0,duration:1e3,onComplete:()=>{e.destroy()}})}const e=this.add.text(t.x,t.y,"-10",{fontSize:"48px",color:"red",fontStyle:"bold",fontFamily:"Helvetica",stroke:"black",strokeThickness:10});e.setOrigin(.5),this.tweens.add({targets:e,y:e.y-50,alpha:0,duration:500,onComplete:()=>{e.destroy()}})}),"medium",s)}playerMGBulletHitEnemy(e,t){e.body.setVelocity(0),this.physics.world.remove(e.body);const s=Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)/1e3;e.explode((()=>{if(t.updateHealth(1),t.active){const e=this.add.text(this.player.x,this.player.y,"Enemy Hit",{fontSize:"24px",color:"white",fontStyle:"bold",fontFamily:"Helvetica"});this.scoreManager.increaseScore(1),e.setOrigin(.5),this.tweens.add({targets:e,y:e.y-50,alpha:0,duration:1e3,onComplete:()=>{e.destroy()}})}else{this.player.killEnemy(),this.scoreManager.increaseScore(100),this.gameUI.showMedal();const e=this.add.text(this.player.x,this.player.y,"Enemy killed",{fontSize:"48px",color:"white",fontStyle:"bold",fontFamily:"Helvetica"});e.setOrigin(.5),this.tweens.add({targets:e,y:e.y-50,alpha:0,duration:1e3,onComplete:()=>{e.destroy()}})}const e=this.add.text(t.x,t.y,"-1",{fontSize:"48px",color:"red",fontStyle:"bold",fontFamily:"Helvetica",stroke:"black",strokeThickness:10});e.setOrigin(.5),this.tweens.add({targets:e,y:e.y-50,alpha:0,duration:500,onComplete:()=>{e.destroy()}})}),"small",s)}getPlayer(){return this.player}getEnemies(){return this.enemies}getGameUI(){return this.gameUI}getPauseUI(){return this.pauseUI}getGameOverUI(){return this.gameOverUI}getStateMachine(){return this.stateMachine}}const G=R;class K extends Phaser.Scene{constructor(){super({key:"BootScene"})}preload(){this.cameras.main.setBackgroundColor(0),this.createLoadingGraphics(),this.load.on("progress",(e=>{this.progressBar.clear(),this.progressBar.fillStyle(8971347,1),this.progressBar.fillRect(this.cameras.main.width/4,this.cameras.main.height/2-16,this.cameras.main.width/2*e,16)})),this.load.on("complete",(()=>{this.progressBar.destroy(),this.loadingBar.destroy()}),this),this.load.pack("preload","./assets/pack.json","preload"),this.input.setDefaultCursor("url(assets/cursors/cursor_none.png), pointer")}update(){this.scene.start("MenuScene")}createLoadingGraphics(){this.loadingBar=this.add.graphics(),this.loadingBar.fillStyle(16777215,1),this.loadingBar.fillRect(this.cameras.main.width/4-2,this.cameras.main.height/2-18,this.cameras.main.width/2+4,20),this.progressBar=this.add.graphics()}}const L=K;class U extends Phaser.Scene{constructor(){super({key:"MenuScene"}),this.bitmapTexts=[],this.start=!1}init(){this.input.keyboard&&(this.startKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.startKey.isDown=!1),this.menuMusics=[this.sound.add("music1"),this.sound.add("music2")]}create(){const e=this.add.image(900,600,"wallpaper");e.setOrigin(.5),e.setScale(i/e.height),this.bitmapTexts.push(this.add.bitmapText(200,this.sys.canvas.height/2+300,"font","NOTHING HAPPENED IN NINETEEN EIGHTY-NINE",30).setTint(16711680));const t=this.add.bitmapText(200,this.sys.canvas.height/2+400,"font","PRESS S TO PLAY",30).setTint(16711680);this.tweens.add({targets:t,alpha:0,duration:1e3,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.bitmapTexts.push(t),this.bitmapTexts.push(this.add.bitmapText(200,this.sys.canvas.height/2+200,"font","TANK WAR",100).setTint(16711680)),this.currentMusic=this.menuMusics[Phaser.Math.RND.between(0,this.menuMusics.length-1)],this.currentMusic.play(),console.log("haha"),this.start=!1}update(){this.currentMusic.isPlaying||this.start||(this.currentMusic=this.menuMusics[Phaser.Math.RND.between(0,this.menuMusics.length-1)],this.currentMusic.play()),this.startKey.isDown&&!this.start&&(this.start=!0,this.cameras.main.fadeOut(500),this.cameras.main.once("camerafadeoutcomplete",(()=>{this.scene.start("GameScene")})))}shutdown(){this.currentMusic.stop()}}const V=U,j={title:"Tank War",version:"0.0.1",type:Phaser.AUTO,width:1600,height:i,parent:"game",scene:[L,V,G],input:{keyboard:!0},physics:{default:"arcade",arcade:{gravity:{x:0,y:0}}},backgroundColor:"#80BE1F",render:{antialias:!0},scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH}};class _ extends Phaser.Game{constructor(e){super(e)}}window.addEventListener("load",(()=>{new _(j)}))}},s={};function i(e){var a=s[e];if(void 0!==a)return a.exports;var h=s[e]={exports:{}};return t[e].call(h.exports,h,h.exports,i),h.exports}i.m=t,e=[],i.O=(t,s,a,h)=>{if(!s){var n=1/0;for(c=0;c<e.length;c++){for(var[s,a,h]=e[c],o=!0,r=0;r<s.length;r++)(!1&h||n>=h)&&Object.keys(i.O).every((e=>i.O[e](s[r])))?s.splice(r--,1):(o=!1,h<n&&(n=h));if(o){e.splice(c--,1);var l=a();void 0!==l&&(t=l)}}return t}h=h||0;for(var c=e.length;c>0&&e[c-1][2]>h;c--)e[c]=e[c-1];e[c]=[s,a,h]},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var a,h,[n,o,r]=s,l=0;if(n.some((t=>0!==e[t]))){for(a in o)i.o(o,a)&&(i.m[a]=o[a]);if(r)var c=r(i)}for(t&&t(s);l<n.length;l++)h=n[l],i.o(e,h)&&e[h]&&e[h][0](),e[h]=0;return i.O(c)},s=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var a=i.O(void 0,[96],(()=>i(742)));a=i.O(a)})();